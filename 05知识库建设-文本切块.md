

## 2.2 文本的切块

```python
    def split_text1(self, text: str) -> List[str]:
        if self.pdf:
            text = re.sub(r"\n{3,}", "\n", text)
            text = re.sub('\s', ' ', text)
            text = text.replace("\n\n", "")
        sent_sep_pattern = re.compile('([﹒﹔﹖﹗．。！？]["’”」』]{0,2}|(?=["‘“「『]{1,2}|$))')  # del ：；
        sent_list = []
        for ele in sent_sep_pattern.split(text):
            if sent_sep_pattern.match(ele) and sent_list:
                sent_list[-1] += ele
            elif ele:
                sent_list.append(ele)
        return sent_list
```

**原理解析**⭐⭐⭐⭐⭐⭐⭐⭐⭐

1. 数据预处理，替换连选3个的换行符；替换\s；替换2个换行符
2. 正则匹配规则设定
  - [﹒﹔﹖﹗．。！？]：中文和英文的常见句号、叹号、问号等。
  - ["’”」』]{0,2}：匹配引号或其他标点符号的右侧标点，最多匹配2个。
  - `(?=["‘“「『]{1,2}|$)`：零宽正向预测断言，匹配左侧标点或句子结尾。
3. 以正则规则进行分割
4. 以正则规则进行切分



样例：

```
文本块1:  
内容: "人工智能（AI）自20世纪50年代起开始发展，最初受到图灵测试等思想的启发..."  
标识符: block_1  
元数据: {  
    "来源": "人工智能发展历史文档",  
    "章节": "第一章: 人工智能的起源",  
    "关键字": ["图灵测试", "起源", "20世纪50年代"]  
}  
  
文本块2:  
内容: "随着计算机技术的不断进步，人工智能领域逐渐涌现出许多重要的里程碑..."  
标识符: block_2  
元数据: {  
    "来源": "人工智能发展历史文档",  
    "章节": "第二章: 人工智能的里程碑",  
    "关键字": ["计算机技术", "里程碑", "进展"]  
}  
...
```

